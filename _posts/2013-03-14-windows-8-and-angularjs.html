---
layout: post
title: Building Windows 8 Applications with AngularJS aka Oh Yes I Did!
date: 2013-03-14 04:56:14.000000000 -07:00
type: post
published: true
status: publish
categories:
- AngularJS
- JavaScript
- jQuery
tags: []
meta:
  _edit_last: '8'
  _nina_cross_promo: a:1:{s:8:"template";s:17:"custom_1399328552";}
  _thumbnail_id: '919'
  _yoast_wpseo_primary_category: ''
  _wpcom_is_markdown: '1'
author:
  login: ohmadmin
  email: simpul@gmail.com
  display_name: Lukas Ruebbelke
  first_name: Lukas
  last_name: Ruebbelke
---
<p><img src="{{ site.baseurl }}/img/blank.png" alt="" /></p>
<p>I am a huge fan of HTML5 and JavaScript because they run on just about anything. I remember when web applications were in their infancy and the golden promise was that you could make a web application feel just like a desktop application - in a browser! Now we have come full circle into this weird parallel universe where we are putting web applications INTO desktop applications. It is heady and high times my friend!</p>
<h3>Backstory</h3>
<p>Aside from my JavaScript interests, I spend a lot of time doing events for the community. My partner in crime Aaron Murray <a href="https://twitter.com/WeAreFractal">@WeAreFractal</a> and I are putting on an event called <a title="The JavaScript Taste Test" href="http://www.jstastetest.com/" target="_blank">The JavaScript Taste Test</a> with Microsoft where we will be exploring what you can actually do with HTML5 and JavaScript.</p>
<p>I was personally intrigued if I could write a Windows 8 application in JUST HTML5 and JavaScript. Could I do it on a Mac? Would it be hard? Would THIS happen to me?</p>
<p><img class="alignnone size-medium wp-image-591" alt="Lost Ark" src="{{ site.baseurl }}/img/lost_ark-300x220.jpg" width="300" height="220" /></p>
<p>Well I am going to just spare you the agony of wondering if I am even alive right now. It was pretty painless and felt pretty much like writing a web application. I kept my eyes closed the entire time! +1 if you get the joke.</p>
<h3>Part Zero: The Source Files</h3>
<p>You can download my project <a title="Source Files" href="http://onehungrymind.com/downloads/HelloAngularWin8.zip">here</a> if you want to follow along.</p>
<h3>Part One: Testing the Waters</h3>
<p>Microsoft has done a good job lately of making helpful tools available for the development community free of charge.</p>
<p>If you do not have a copy of Windows, you can download a VM image from <a title="Modern.ie" href="http://www.modern.ie/en-us" target="_blank">http://www.modern.ie/en-us</a> to get started.</p>
<p>The most economical choice is to use the <a title="VirtualBox" href="https://www.virtualbox.org/wiki/Downloads" target="_blank">VirtualBox</a> image since VirtualBox is free of charge. I have a lot of friends that swear by VirtualBox and I take their word for it. I use <a title="Parallels" href="http://www.parallels.com/products/desktop/" target="_blank">Parallels</a> and so I downloaded the VMWare Fusion image and just converted it. Took me all of about 40 minutes to download and get up and running. Bam!</p>
<p>From the VM, I downloaded Visual Studio Express for Windows 8 from <a title="Visual Studio Express for Windows 8" href="http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-8" target="_blank">http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-windows-8</a>.</p>
<p>So, at this point, I was still pretty skeptical, so I figured the obligatory "Hello World" was in order, which I found <a title="Hello World" href="http://msdn.microsoft.com/en-us/library/windows/apps/hh986964.aspx" target="_blank">here</a>.</p>
<p>This took all of about 20 minutes to do and, so now I have about a 2 hour investment into the process. Not too bad!</p>
<h3>Part Two: So About That AngularJS?</h3>
<p>So now my curiosity is totally piqued. Can it be done man!?</p>
<p><strong>Step 1: Create a New Project</strong></p>
<p>So first things first, we need to create a new project. Ctrl + shift + n and you are on your way!</p>
<p>I left all the defaults as is and called the project HelloAngular. You can see my settings in the image below.</p>
<p><a href="http://onehungrymind.com/wp-content/uploads/2013/03/step_one.png"><img class="alignnone size-medium wp-image-593" alt="HelloAngular Step One" src="{{ site.baseurl }}/img/step_one-300x207.png" width="300" height="207" /></a></p>
<p><strong>Step 2: Import AngularJS</strong></p>
<p>Windows 8 applications require that all your scripts run local for security reasons and so I downloaded the latest <strong>angular.min.js</strong> and dropped it into the <strong>js</strong> folder of the project.</p>
<p><strong>Step 3: Include AngularJS and Roll Dice</strong></p>
<p>So I wanted to see if I could just bootstrap an AngularJS application and so I referenced the script and added <strong>ng-app</strong> to the <strong>html</strong> tag of the<strong> default.html</strong> file.</p>
<p>
  {% highlight html %}
  <html ng-app>
  <head>
    <meta charset="utf-8" />
    <title>Hello AngularJS!</title>
    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>
    <!-- HelloAngular references -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/angular.min.js"></script>
    <script src="/js/default.js"></script>
  </head>
  ...
  </html>
  {% endhighlight %}
</p>
<p>Oh noes!</p>
<p><img class="alignnone size-medium wp-image-597" alt="Oh Noes!" src="{{ site.baseurl }}/img/ohnoes-300x258.jpeg" width="300" height="258" /></p>
<p><em>"JavaScript runtime error: Unable to add dynamic content."</em></p>
<p><strong>Step 4: A Little Help From My Friends</strong></p>
<p>To the Googles! A little poking around and I found that I was not the first one to experience this. A gentleman by the name of Jonathan Channon shed all the light I needed on this conundrum. You can read his post <a title="Jonathan Channon" href="http://blog.jonathanchannon.com/2013/01/24/using-angularjsbackbonejs-in-windows-8-javascript-app/">here</a>.</p>
<p>Enter JavaScript juggernaut Elijah Manor <a title="Elijah Manor" href="https://twitter.com/elijahmanor" target="_blank">@elijahmanor</a> and his breakdancing crew with a custom version of jQuery. WINDOWS 8 STYLE!</p>
<p>Oh appendTo... I love you!</p>
<p>The moral of the story is to use jquery-win8 from <a title="jQuery Win8" href="https://github.com/appendto/jquery-win8" target="_blank">here</a></p>
<p>Add the file to the <strong>js</strong> folder.</p>
<p><a href="http://onehungrymind.com/wp-content/uploads/2013/03/step_two.png"><img class="alignnone size-medium wp-image-592" alt="Hello Angular Step Two" src="{{ site.baseurl }}/img/step_two-231x300.png" width="231" height="300" /></a></p>
<p>Include the script and make one small tweak as you can see below. Friction removed!</p>
<p>{% highlight html %}</p>
<link href="/css/default.css" rel="stylesheet" />
<script src="js/jquery-1.8.2-win8-1.0.min.js"></script><br />
<script type="text/javascript"><br />
jQuery.isUnsafe = true;<br />
</script><br />
<script src="/js/angular.min.js"></script><br />
<script src="/js/default.js"></script><br />
{% endhighlight %}</p>
<p>Behold the choir of angels! It works!</p>
<p><strong>Step 5: Build Something!</strong></p>
<p>I am not going to delve too much into the AngularJS application I built since it is super 101 level stuff, but here is the basic rundown.</p>
<p>In the <strong>js</strong> folder, open <strong>default.js</strong> and jump right to the bottom of the file. Just above the <strong>app.start();</strong> function call is where I decided to craft my AngularJS app.</p>
<p>First, I define my AngularJS module, and then I define a MainCtrl on that module to hold my data and methods for the application.</p>
<p>{% highlight html %}<br />
  // AngularJS Stuff<br />
  var myApp = angular.module('app', []);</p>
<pre><code>myApp.controller('MainCtrl', function ($scope) {
    $scope.greeting = 'Hello AngularJS!';
});
</code></pre>
<p>{% endhighlight %}</p>
<p>Now that I have a defined module, I am going to bootstrap the AngularJS application to use that module. That is as simple as updating <strong>ng-app</strong> to <strong>ng-app="app"</strong> in the html tag.</p>
<p>{% highlight html %}<br />
  <html ng-app="app"><br />
  {% endhighlight %}</p>
<p>Now I want to give the reins to <strong>MainCtrl</strong> to do its thing. I do this by using the AngularJS <strong>ng-controller</strong> directive with a value of <strong>MainCtrl</strong>. This essentially sets up the relationship between <strong>$scope</strong> and the HTML. Notice that I created a <strong>greeting</strong> property on <strong>$scope</strong> when I defined the controller. I can bind to that in the HTML using the doubly curly brace syntax a la <strong>{{greeting}}</strong>.</p>
<p><em>Side note: Directives are an entirely different conversation for another day, but for now think of them as "html elements with super powers".</em></p>
<p>{% highlight html %}<br />
<body ng-controller="MainCtrl"></p>
<h1>{{greeting}}</h1>
<p></body><br />
  {% endhighlight %}</p>
<p>Moving along...I am going to add a <strong>messages</strong> array to hold well...messages. Self documenting code FTW! And I am going to create a method called <strong>addMessage</strong> that adds a <strong>message</strong> to the front of the array via <strong>unshift</strong>. By adding these methods and properties to the <strong>$scope</strong> object, I am making them available to the elements that exist within the HTML element that we defined the controller on. You will notice that I am also setting a <strong>message</strong> property to an empty string. More on that in just a moment.</p>
<p>[js]<br />
  var myApp = angular.module('app', []);</p>
<pre><code>myApp.controller('MainCtrl', function ($scope) {
    $scope.greeting = 'Hello AngularJS!';
    $scope.messages = [];
    $scope.addMessage = function (m) {
        $scope.messages.unshift(m);
        $scope.message = '';
    }
});
</code></pre>
<p>[/js]</p>
<p>To the HTML! Let's start with the messages. I want to display all the messages that exist and so I do that with <strong>ng-repeat</strong>. <strong>ng-repeat</strong> is an AngularJS directive that essentially loops over an array and stamps out whatever element it is defined on. So in this case we are saying "Create a new <strong>p</strong> tag with the value of <strong>m</strong> for every <strong>message</strong> that exists in <strong>messages</strong>". From there we are back to the curly braces for the binding.</p>
<p>And to add a message, we first declare <strong>ng-model="message"</strong> on the <strong>messageInput</strong> element. This essentially sets up two-way binding with <strong>$scope</strong> from the HTML side. We are going to call <strong>addMessage</strong> by adding <strong>ng-click="addMessage(message)"</strong> to the <strong>messageButton</strong>. The <strong>ng-click</strong> directive takes all of that messy event listening handlers and takes care of the biz for you. We are passing it the <strong>message</strong> value which is essentially whatever is in the <strong>messageInput</strong> field thanks to <strong>ng-model</strong>.</p>
<p>{% highlight html %}<br />
<body ng-controller="MainCtrl"></p>
<h1>{{greeting}}</h1>
<p>Leave a message.<br />
  <input id="messageInput" ng-model="message" type="text" /><br />
  <button id="messageButton" ng-click="addMessage(message)">Say "Hello"</button>
</p>
<div id="greetingOutput">
  <p ng-repeat="m in messages">{{m}}</p>
  </p></div>
<p></body><br />
  {% endhighlight %}</p>
<p>And that my friends is how I did it! Behold!</p>
<p><a href="http://onehungrymind.com/wp-content/uploads/2013/03/angular_metro.png"><img class="alignnone size-medium wp-image-594" alt="Angular Metro" src="{{ site.baseurl }}/img/angular_metro-300x204.png" width="300" height="204" /></a></p>
<h3>Conclusion</h3>
<p>I could have definitely dug into the AngularJS side a bit more, but I wanted to highlight how easy it was to get up and running, even for a guy on a Mac running Windows in a VM. It was really just HTML5 and JavaScript! Hooray!</p>
<p>AngularJS<br />
  <a title="AngularJS" href="http://angularjs.org/" target="_blank">http://angularjs.org/</a></p>
<p>Modern.ie<br />
  <a title="Modern.ie" href="http://www.modern.ie/en-us/" target="_blank">http://www.modern.ie/en-us/</a></p>
<p>VirtualBox<br />
  <a title="VirtualBox" href="https://www.virtualbox.org/" target="_blank">https://www.virtualbox.org/</a></p>
<p>jQuery for Windows 8 Store Applications<br />
  <a title="jQuery for Windows 8 Store Applications" href="https://github.com/appendto/jquery-win8" target="_blank">https://github.com/appendto/jquery-win8</a></p>
<p>Create your first Windows Store app using JavaScript<br />
  <a title="Create your first Windows Store app using JavaScript" href="http://msdn.microsoft.com/en-us/library/windows/apps/br211385.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/apps/br211385.aspx</a></html></html></p>
